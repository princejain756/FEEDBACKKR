{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nconst AUTH_KEY = 'kriedko_admin_auth';\nexport function getStoredAuth() {\n  try {\n    const raw = localStorage.getItem(AUTH_KEY);\n    return raw ? JSON.parse(raw) : null;\n  } catch {\n    return null;\n  }\n}\nexport function setStoredAuth(auth) {\n  try {\n    if (!auth) {\n      localStorage.removeItem(AUTH_KEY);\n      return;\n    }\n    localStorage.setItem(AUTH_KEY, JSON.stringify(auth));\n  } catch {}\n}\nexport const useAuth = () => {\n  _s();\n  const [auth, setAuth] = useState(() => getStoredAuth());\n  useEffect(() => {\n    // keep state in sync with storage (basic)\n    const handle = () => setAuth(getStoredAuth());\n    window.addEventListener('storage', handle);\n    return () => window.removeEventListener('storage', handle);\n  }, []);\n  const isAuthenticated = useMemo(() => !!(auth !== null && auth !== void 0 && auth.isAuthenticated), [auth]);\n  const login = useCallback(async (username, password) => {\n    try {\n      const res = await fetch('/api/login', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          username: String(username || '').trim(),\n          password: String(password || '').trim()\n        })\n      });\n      if (!res.ok) return {\n        success: false\n      };\n      const payload = {\n        isAuthenticated: true,\n        username: String(username || '').trim(),\n        loginAt: new Date().toISOString()\n      };\n      setStoredAuth(payload);\n      setAuth(payload);\n      return {\n        success: true\n      };\n    } catch (_) {\n      return {\n        success: false\n      };\n    }\n  }, []);\n  const logout = useCallback(async () => {\n    try {\n      await fetch('/api/logout', {\n        method: 'POST'\n      }).catch(() => {});\n    } catch {}\n    setStoredAuth(null);\n    setAuth(null);\n  }, []);\n  return {\n    auth,\n    isAuthenticated,\n    login,\n    logout\n  };\n};\n_s(useAuth, \"eVY1xA89+KZ8dX6sZTgwhfRdAS4=\");\nexport const requireAuth = () => {\n  var _getStoredAuth;\n  return !!((_getStoredAuth = getStoredAuth()) !== null && _getStoredAuth !== void 0 && _getStoredAuth.isAuthenticated);\n};","map":{"version":3,"names":["useCallback","useEffect","useMemo","useState","AUTH_KEY","getStoredAuth","raw","localStorage","getItem","JSON","parse","setStoredAuth","auth","removeItem","setItem","stringify","useAuth","_s","setAuth","handle","window","addEventListener","removeEventListener","isAuthenticated","login","username","password","res","fetch","method","headers","body","String","trim","ok","success","payload","loginAt","Date","toISOString","_","logout","catch","requireAuth","_getStoredAuth"],"sources":["/Users/princejain756/feedback form/src/hooks/useAuth.js"],"sourcesContent":["import { useCallback, useEffect, useMemo, useState } from 'react';\n\nconst AUTH_KEY = 'kriedko_admin_auth';\n\nexport function getStoredAuth() {\n  try {\n    const raw = localStorage.getItem(AUTH_KEY);\n    return raw ? JSON.parse(raw) : null;\n  } catch {\n    return null;\n  }\n}\n\nexport function setStoredAuth(auth) {\n  try {\n    if (!auth) {\n      localStorage.removeItem(AUTH_KEY);\n      return;\n    }\n    localStorage.setItem(AUTH_KEY, JSON.stringify(auth));\n  } catch {}\n}\n\nexport const useAuth = () => {\n  const [auth, setAuth] = useState(() => getStoredAuth());\n\n  useEffect(() => {\n    // keep state in sync with storage (basic)\n    const handle = () => setAuth(getStoredAuth());\n    window.addEventListener('storage', handle);\n    return () => window.removeEventListener('storage', handle);\n  }, []);\n\n  const isAuthenticated = useMemo(() => !!auth?.isAuthenticated, [auth]);\n\n  const login = useCallback(async (username, password) => {\n    try {\n      const res = await fetch('/api/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username: String(username || '').trim(), password: String(password || '').trim() })\n      });\n      if (!res.ok) return { success: false };\n      const payload = {\n        isAuthenticated: true,\n        username: String(username || '').trim(),\n        loginAt: new Date().toISOString(),\n      };\n      setStoredAuth(payload);\n      setAuth(payload);\n      return { success: true };\n    } catch (_) {\n      return { success: false };\n    }\n  }, []);\n\n  const logout = useCallback(async () => {\n    try { await fetch('/api/logout', { method: 'POST' }).catch(() => {}); } catch {}\n    setStoredAuth(null);\n    setAuth(null);\n  }, []);\n\n  return {\n    auth,\n    isAuthenticated,\n    login,\n    logout,\n  };\n};\n\nexport const requireAuth = () => !!getStoredAuth()?.isAuthenticated;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}